# Improved Pywallet - Python 3 Compatible Bitcoin Wallet Tool

This is an improved version of pywallet with full Python 3 support and enhanced recovery features.

## New Features

### 1. **Full Python 3 Support** ✅
- Removed experimental Python 3 warnings
- Fixed all Python 2/3 compatibility issues
- Proper string/bytes handling
- Updated deprecated function calls

### 2. **Enhanced Key Recovery** ✅
- **New `--output_keys` option**: Export recovered keys to a text file instead of creating a wallet
- **Improved size format support**: Now accepts both old (Mo, Gio) and new (MB, GB) formats
- **Better error handling**: Clearer error messages and validation

### 3. **Backward Compatibility** ✅
- All original functionality preserved
- Existing command-line options work unchanged
- Compatible with existing wallet files

## Installation

### Quick Setup
```bash
# Make build script executable and run it
chmod +x build.sh
./build.sh
```

### Manual Setup
```bash
# Install system dependencies (Ubuntu/Debian)
sudo apt-get install libdb-dev python3-dev build-essential python3-venv

# Create virtual environment
python3 -m venv pywallet_build_env
source pywallet_build_env/bin/activate

# Install Python dependencies
pip install --upgrade pip
pip install bsddb3
```

## Usage

### Using the Run Script (Recommended)
```bash
# Show help
./run_pywallet.sh --help

# Recover keys to text file (NEW FEATURE)
./run_pywallet.sh --recover --recov_device=/dev/sda1 --recov_size=100MB --output_keys=recovered_keys.txt

# Traditional wallet recovery
./run_pywallet.sh --recover --recov_device=/dev/sda1 --recov_size=100MB --recov_outputdir=./recovery
```

### Manual Usage
```bash
# Activate virtual environment
source pywallet_build_env/bin/activate

# Run pywallet
python3 pywallet/pywallet.py [options]
```

## New Command Line Options

### `--output_keys=FILENAME`
Export recovered private keys to a text file instead of creating a wallet.
- **Usage**: `--output_keys=keys.txt`
- **Output format**: One private key per line in hex format
- **Includes**: Both compressed and uncompressed versions of each key
- **Use with**: `--recover` option

### Enhanced `--recov_size`
Now supports modern size formats:
- **Old formats**: `20Mo`, `50Gio` (still supported)
- **New formats**: `20MB`, `50GB`, `100MB`, `2GB`
- **Examples**: 
  - `--recov_size=100MB`
  - `--recov_size=2GB`
  - `--recov_size=500MB`

## Examples

### 1. Basic Key Recovery to Text File
```bash
./run_pywallet.sh --recover \
    --recov_device=/dev/sda1 \
    --recov_size=500MB \
    --output_keys=my_recovered_keys.txt
```

### 2. Large Scale Recovery
```bash
./run_pywallet.sh --recover \
    --recov_device=/dev/sdb1 \
    --recov_size=10GB \
    --output_keys=all_keys.txt
```

### 3. File-based Recovery
```bash
./run_pywallet.sh --recover \
    --recov_device=/path/to/disk/image.img \
    --recov_size=1GB \
    --output_keys=recovered.txt
```

### 4. Traditional Wallet Creation (Unchanged)
```bash
./run_pywallet.sh --recover \
    --recov_device=/dev/sda1 \
    --recov_size=100MB \
    --recov_outputdir=./wallet_recovery
```

## Output Format

When using `--output_keys`, the text file contains:
```
# Recovered private keys
# Generated by pywallet recovery
# Format: one private key per line (hex format)

5KJvsngHeMpm884wtkJNzQGaCErckhHJBGFsvd3VyK5qMZXj3hS
5KJvsngHeMpm884wtkJNzQGaCErckhHJBGFsvd3VyK5qMZXj3hS01
3c9229289a6125f7fdf1885a77bb12c37a8d3b4962d936f7e3084dece32a3ca1
3c9229289a6125f7fdf1885a77bb12c37a8d3b4962d936f7e3084dece32a3ca101
...
```

## System Requirements

- **Python**: 3.6 or higher
- **OS**: Linux, macOS, Windows (with WSL)
- **Memory**: Minimum 1GB RAM
- **Storage**: Depends on recovery size

## Troubleshooting

### Virtual Environment Issues
```bash
# Recreate virtual environment
rm -rf pywallet_build_env
./build.sh
```

### Permission Issues
```bash
# Make scripts executable
chmod +x build.sh run_pywallet.sh
```

### Missing Dependencies
```bash
# Install system dependencies
sudo apt-get install libdb-dev python3-dev build-essential
```

## Version Information

- **Version**: 2.2-py3-improved
- **Python Support**: 3.6+
- **Based on**: pywallet 2.2
- **Improvements**: Python 3 compatibility, enhanced recovery features

## License

Same as original pywallet project.